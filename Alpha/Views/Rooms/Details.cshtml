@using System.Security.Claims

@{
    bool IsManager = User.IsInRole("Manager");
}
@model Alpha.Models.Room

@{
    ViewData["Title"] = "Details";
}

<h2>
    @Html.DisplayFor(model => model.Name)
</h2>

<div class="row">
    <div class="col-xs-12 header">
        <a asp-action="Index">&larr;&nbsp;Back to rooms</a>
        &nbsp;|&nbsp;
        <a asp-action="Edit" asp-route-id="@Model.Id">&#10003;&nbsp;Edit</a>
        &nbsp;|&nbsp;
        <a asp-action="Remove" asp-route-id="@Model.Id">x&nbsp;Remove</a>
    </div>
</div>

<div class="row rooms">
    <div class="col-xs-2">
        <span class="icon"><span class="icon">&#9675;</span><strong>@Html.DisplayFor(model => model.Seats)</strong> seats</span>
    </div>
    @if (Model.Projector)
    {
        <div class="col-xs-2">
            <span class="icon"><span class="icon">&#9899;</span>@Html.DisplayNameFor(model => model.Projector)</span>
        </div>
    }
    @if (Model.Board)
    {
        <div class="col-xs-3">
            <span class="icon"><span class="icon">&#10002;</span>@Html.DisplayNameFor(model => model.Board)</span>
        </div>
    }
</div>
    <div class="row">
        <div class="col-xs-12">
            <strong>@Html.DisplayNameFor(model => model.Descrtiption)</strong>
            <br /><br />
            @Html.DisplayFor(model => model.Descrtiption)
        </div>
    </div>
    <a asp-area="" asp-controller="Reservations" asp-action="Add" asp-route-id="@Model.Id">
        <div class="row">
            <div class="col-xs-12">
                <strong>+ Add reservation</strong>
            </div>
        </div>
    </a>
    @if (Model.Reservations.Count > 0)
    {
        <div class="row">
            <div class="col-xs-4">
                <a class="header" href="#">Date / Time &uarr;</a>
            </div>
            <div class="col-xs-8">
                <a class="header" href="#">Owner</a>
            </div>
        </div>
        @foreach (var item in Model.Reservations.OrderBy(r => r.Start))
        {
            <a class=@(IsManager ? "" : "disabled") asp-controller="Reservations" asp-action="Edit" asp-route-id="@item.Id">
                <div class="row">
                    <div class="col-xs-4">
                        @item.Start.DayOfWeek, @item.Start.ToShortDateString(),
                        <nowrap>@item.Start.ToShortTimeString()&#150;@item.End.ToShortTimeString()</nowrap>
                    </div>
                    <div class="col-xs-8">
                        @item.User.Name
                    </div>
                </div>
            </a>
        }
    }
